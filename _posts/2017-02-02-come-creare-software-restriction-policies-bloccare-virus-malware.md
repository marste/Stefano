---
title: Come creare delle software restriction policies per bloccare virus e malware
date: 2017-02-02 09:01:00 +0200
published: true
author: Stefano Marzorati
layout: post
permalink: /come-creare-software-restriction-policies-bloccare-virus-malware/
categories:
  - Windows
tags:
  - policies
  - group
  - software
  - restriction
  - virus
  - malware
  - block
---
<p align="center">
  <img src="https://c1.staticflickr.com/1/649/32661969245_4612f0d63f_o.png">
</p>

Go to **Computer Configuration** -> **Policies** -> **Windows Settings** -> **Security Settings** -> **Software Restriction Policies** and right click it to open a menu where you choose **New Software Restriction Policies**.   

<p align="center">
  <img src="https://c1.staticflickr.com/1/727/32661969305_d01cffcd59_o.png">
</p>

Open **Additional Rules** and right click it to create a **New Path Rule**.   

<p align="center">
  <img src="https://c1.staticflickr.com/1/609/32661969365_4bb494b7b5_o.png">
</p>

Import the rules that are listed below.

**Block executable in %AppData%:**   

* Path:   
<code>%AppData%\*.exe</code>   
* Security Level:   
<code>Disallowed</code>   

**Block executable in %LocalAppData%:**   

* Path if using Windows XP:   
<code>%UserProfile%\Local Settings\*.exe</code>   
* Path if using Windows Vista/7/8:   
<code>%LocalAppData%\*.exe</code>   
* Security Level:   
<code>Disallowed</code>   

**Block executable in %AppData% subfolders:**   

* Path:   
<code>%AppData%\*\*.exe</code>   
* Security Level:   
<code>Disallowed</code>   

**Block executable in %LocalAppData% subfolders:**   

* Path if using Windows XP:   
<code>%UserProfile%\Local Settings\*\*.exe</code>   
* Path if using Windows Vista/7/8:   
<code>%LocalAppData%\*\*.exe</code>   
* Security Level:   
<code>Disallowed</code>   

**Block executables run from archive attachments opened with WinRAR:**   

* Path if using Windows XP:   
<code>%UserProfile%\Local Settings\Temp\Rar*\*.exe</code>   
* Path if using Windows Vista/7/8:   
<code>%LocalAppData%\Temp\Rar*\*.exe</code>   
* Security Level:   
<code>Disallowed</code>   

**Block executables run from archive attachments opened with 7zip:**   

* Path if using Windows XP:   
<code>%UserProfile%\Local Settings\Temp\7z*\*.exe</code>   
* Path if using Windows Vista/7/8:   
<code>%LocalAppData%\Temp\7z*\*.exe</code>   
* Security Level:   
<code>Disallowed</code>   

**Block executables run from archive attachments opened with WinZip:**   

* Path if using Windows XP:   
<code>%UserProfile%\Local Settings\Temp\wz*\*.exe</code>   
* Path if using Windows Vista/7/8:   
<code>%LocalAppData%\Temp\wz*\*.exe</code>   
* Security Level:   
<code>Disallowed</code>   

**Block executables run from archive attachments opened using Windows built-in Zip support:**   

* Path if using Windows XP:   
<code>%UserProfile%\Local Settings\Temp\*.zip\*.exe</code>   
* Path if using Windows Vista/7/8:   
<code>%LocalAppData%\Temp\*.zip\*.exe</code>   
* Security Level:   
<code>Disallowed</code>   

<p align="center">
  <img src="https://c1.staticflickr.com/1/454/32508764552_3d5d03c1d9_o.png">
</p>

Now testing the Software Restriction Policies on a client computer (note: if the user is already logged on, you need to relog, a **GPUPDATE /force** doesnâ€™t work)   

<p align="center">
  <img src="https://c1.staticflickr.com/1/509/32621270536_649985f08f_o.png">
</p>

Voila, but the user cannot start Teamviewer with those rules what if you want an exception for this or other legitimate software. For this you can make other rules:   

<p align="center">
  <img src="https://c1.staticflickr.com/1/518/32621270596_3a6baf16d9_o.png">
</p>

