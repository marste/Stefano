---
layout: default
---

<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <title>{{ page.title | default: site.title }}</title>
  <style>
    body { margin:0; font-family: system-ui, sans-serif; overflow: hidden; }
    #blocker-screen {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #ff5f6d, #ffc371);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      z-index: 999999;
      padding: 20px;
      transition: opacity 0.6s;
    }
    #blocker-screen.hide { opacity: 0; pointer-events: none; }
    .box { max-width: 620px; background: rgba(0,0,0,0.35); padding: 50px 40px; border-radius: 20px; backdrop-filter: blur(10px); }
    h1 { font-size: 3rem; margin: 0 0 20px; }
    p { font-size: 1.3rem; line-height: 1.6; }
    button {
      margin-top: 30px;
      padding: 14px 36px;
      font-size: 1.2rem;
      background: white;
      color: #ff5f6d;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      font-weight: bold;
    }
    #real-content { visibility: hidden; }
    #real-content.visible { visibility: visible; }
    body.noscroll { overflow: hidden !important; }
  </style>
</head>
<body class="noscroll">

  <!-- Schermata di blocco -->
  <div id="blocker-screen">
    <div class="box">
      <h1>AdBlock rilevato</h1>
      <p>Questo sito vive grazie alla pubblicità non invasiva.<br>
         Per favore <strong>disabilita l’adblocker</strong> per questo dominio<br>e ricarica la pagina.</p>
      <button onclick="location.reload()">✔ Ho disabilitato AdBlock – Ricarica</button>
    </div>
  </div>

  <!-- Contenuto reale (nascosto finché non passa il test) -->
  <div id="real-content">
    {{ content }}
  </div>

  <!-- === DETECTION TRIPLO (funziona nel 2025) === -->
  <script>
    // Livello 1: Fake Google Adsense (bloccato da quasi tutti)
    const googleBait = document.createElement('script');
    googleBait.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js';
    googleBait.onerror = googleBait.onload = tryNext;

    // Livello 2: File locale "advertising.js" (deve esistere!)
    function tryLocalBait() {
      const local = document.createElement('script');
      local.src = '/advertising.js?' + Date.now();
      local.onerror = blockDetected;
      local.onload = tryFakeRequest;
      document.head.appendChild(local);
    }

    // Livello 3: Richiesta a un URL che tutti gli adblocker bloccano
    function tryFakeRequest() {
      fetch('/ads.txt?' + Date.now(), { method: 'HEAD', mode: 'no-cors' })
        .then(() => showContent())
        .catch(() => blockDetected());
    }

    function blockDetected() {
      // Adblock attivo → lasciamo lo schermo di blocco
      document.body.classList.add('noscroll');
    }

    function showContent() {
      document.getElementById('blocker-screen').classList.add('hide');
      document.getElementById('real-content').classList.add('visible');
      document.body.classList.remove('noscroll');
      setTimeout(() => document.getElementById('blocker-screen').remove(), 700);
    }

    // Avvio catena di rilevamento
    document.head.appendChild(googleBait);
    setTimeout(tryLocalBait, 800);  // fallback
    setTimeout(tryFakeRequest, 1500); // ultimo controllo

    // Controllo finale dopo 3 secondi (cattura anche i ritardatari)
    setTimeout(() => {
      if (!document.getElementById('real-content').classList.contains('visible')) {
        blockDetected();
      }
    }, 3500);
  </script>
</body>
</html>